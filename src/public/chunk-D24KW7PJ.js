import{a as oe,b as re,c as ne,d as C}from"./chunk-7KYVOHKN.js";import{a as te}from"./chunk-EGNXZWMK.js";import{a as ie}from"./chunk-AF44Q6CR.js";import{l as P,p as X}from"./chunk-T37QIOS2.js";import{b as Y,c as j,d as $,e as q,g as z,h as H,i as J,j as K,k as Q,l as W,m as Z,o as ee}from"./chunk-V64ROETT.js";import{$a as c,Db as A,Ha as D,Hb as M,Ib as O,Kb as k,Ma as m,V as h,Y as E,Za as y,eb as i,fb as e,ga as _,gb as d,gc as B,ha as I,kb as V,lb as R,lc as G,mb as L,ub as T,vb as o,wb as F}from"./chunk-6LC4AVBM.js";import{f as p,g as f,h as g}from"./chunk-3WNR6LQO.js";var se=(()=>{var s;let t=class t{constructor(){f(this,s,void 0);this.type="usuario",this.imagen="",g(this,s,h(C))}ngOnInit(){this.img=p(this,s).getImagen(this.type,this.imagen),console.log(this.img)}};s=new WeakMap,t.\u0275fac=function(u){return new(u||t)},t.\u0275cmp=E({type:t,selectors:[["app-view-image"]],inputs:{type:"type",imagen:"imagen"},standalone:!0,features:[A],decls:3,vars:2,consts:[[1,"card"],[1,"card-body"],[3,"src","alt"]],template:function(u,v){u&1&&(i(0,"div",0)(1,"div",1),d(2,"img",2),e()()),u&2&&(m(2),c("src",v.img,D)("alt",v.imagen))}});let r=t;return r})();function me(r,s){if(r&1&&(i(0,"div",32)(1,"div",33)(2,"h2"),o(3,"Glucometrias"),e(),d(4,"ngx-charts-bar-vertical",34),e()()),r&2){let t=L();m(4),c("view",t.view)("scheme",t.colorScheme)("results",t.single)("gradient",t.gradient)("xAxis",t.showXAxis)("yAxis",t.showYAxis)("legend",t.showLegend)("legendPosition",t.legendPosition)("showXAxisLabel",t.showXAxisLabel)("showYAxisLabel",t.showYAxisLabel)("xAxisLabel",t.xAxisLabel)("yAxisLabel",t.yAxisLabel)("legendTitle",t.legendTitle)("wrapTicks",!0)}}function de(r,s){r&1&&(i(0,"div",9)(1,"label",35),o(2,"Correo electr\xF3nico"),e(),d(3,"input",36),e())}function ue(r,s){r&1&&(i(0,"div",9)(1,"label",37),o(2,"Rol"),e(),i(3,"select",38)(4,"option",39),o(5,"Sleccione Rol"),e(),i(6,"option",40),o(7,"Administrador"),e(),i(8,"option",41),o(9,"Usuario"),e()()())}function pe(r,s){if(r&1&&(i(0,"div"),d(1,"app-view-image",42),e()),r&2){let t=L();m(),c("imagen",t.imagen)}}function ce(r,s){r&1&&(i(0,"label",43),o(1," Selecciona archivo"),e())}var ae=(()=>{var s,t,S,x,u,v;let w=class w{constructor(){f(this,s,void 0);f(this,t,void 0);f(this,S,void 0);f(this,x,void 0);f(this,u,void 0);f(this,v,void 0);g(this,s,h(X)),g(this,t,h(C)),g(this,S,h(te)),g(this,x,h(ie)),g(this,u,h(P)),g(this,v,h(Z)),this.view=[900,400],this.showXAxis=!0,this.showYAxis=!0,this.gradient=!0,this.showLegend=!0,this.showXAxisLabel=!0,this.xAxisLabel="Fechas",this.showYAxisLabel=!0,this.yAxisLabel="Glucometrias",this.Below="below",this.legendPosition="below",this.legendTitle="Ultimas 10 fechas de tomas de glucometrias",this.colorScheme={name:"custom",selectable:!0,group:oe.Ordinal,domain:["#5AA454","#A10A28","#C7B42C","#AAAAAA","#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B"]},this.single=[],this.viewChart=!1,this.formUser=p(this,v).nonNullable.group({name:["",[j.required]],password:[""],password2:[""],role:[""],email:[""],sexo:[""],telefono:[""],peso:[""]}),this.uploadImagen=!1}ngOnInit(){this.user=p(this,s).currentUserExists().usuario,this.imagen=this.user.img?this.user.img:"",this.formUser.patchValue({name:this.user.name,role:this.user.role,email:this.user.email,peso:this.user.peso,sexo:this.user.sexo,telefono:this.user.telefono}),p(this,x).getSampling(this.user._id).subscribe(l=>{l.data.length>0&&(l.data.forEach((n,a)=>{if(a<10){let b=new Date(n.fecha),U=new Intl.DateTimeFormat("es-ES",{day:"numeric",month:"short"}).format(b);this.single.push({name:`${n.jornada} - ${U}`,value:n.muestra})}}),this.viewChart=!0)})}cambiarImagen(l){if(this.imagenSubir=l.target.files[0],this.uploadImagen=!0,!l.target.files[0])return this.imgTemp=null;let n=new FileReader;n.readAsDataURL(l.target.files[0]),n.onloadend=()=>{this.imgTemp=n.result||null}}saved(){if(console.log(this.formUser.invalid),this.formUser.markAllAsTouched(),!this.formUser.invalid&&(console.log(this.formUser.getRawValue().password===this.formUser.getRawValue().password2),this.formUser.getRawValue().password===this.formUser.getRawValue().password2)){let l={_id:this.user._id,name:this.formUser.getRawValue().name,role:this.formUser.getRawValue().role,email:this.formUser.getRawValue().email,password:this.formUser.getRawValue().password,sexo:this.formUser.getRawValue().sexo,peso:this.formUser.getRawValue().peso,telefono:this.formUser.getRawValue().telefono};p(this,S).UpdateUser(l).subscribe(n=>{n.ok&&(this.resetSesionStorage(n.usuario),this.uploadImagen&&p(this,t).uploadImage(this.imagenSubir,"usuario",this.user._id).subscribe(a=>{a.ok&&(this.resetSesionStorage(a.usuario),this.imagen=a.usuario.img)}),console.log(n),p(this,u).navigate(["/user"]))})}}resetSesionStorage(l){sessionStorage.removeItem("user");let n={id:l._id,ok:!0,usuario:l};sessionStorage.setItem("user",JSON.stringify(n)),this.user=p(this,s).currentUserExists().usuario}};s=new WeakMap,t=new WeakMap,S=new WeakMap,x=new WeakMap,u=new WeakMap,v=new WeakMap,w.\u0275fac=function(n){return new(n||w)},w.\u0275cmp=E({type:w,selectors:[["app-user-detail"]],standalone:!0,features:[A],decls:55,vars:9,consts:[["ElseImage",""],[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","mb-5"],[1,"btn","btn-outline-warning"],["class","col-12 my-5",4,"ngIf"],[1,"col-12","col-lg-9","mt-5"],[3,"ngSubmit","formGroup"],[1,"form-group","mb-3"],["for","user"],["type","text","id","user","placeholder","Nombre","formControlName","name",1,"form-control"],["for","telefono"],["type","text","id","telefono","placeholder","Tel\xE9fono","formControlName","telefono",1,"form-control"],["for","peso"],["type","text","id","peso","placeholder","Peso en (KG)","formControlName","peso",1,"form-control"],["for","sexo"],["name","sexo","id","sexo","formControlName","sexo",1,"form-control"],["value","Masculino"],["value","Femenino"],["for","password"],["type","password","id","password","placeholder","******","formControlName","password",1,"form-control"],["for","password2"],["type","password","id","password2","placeholder","******","formControlName","password2",1,"form-control"],["class","form-group mb-3",4,"ngIf"],[1,"form-group","mb-3","d-flex","justify-content-between"],["type","submit",1,"btn","btn-success"],["for","file",1,"btn","btn-primary","my-2"],[1,"col-12","col-lg-3","mt-5"],["type","file","name","file","id","file",1,"d-none",3,"change"],[4,"ngIf","ngIfElse"],[1,"mt-2","text-center"],[1,"col-12","my-5"],[2,"display","block"],[3,"view","scheme","results","gradient","xAxis","yAxis","legend","legendPosition","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","legendTitle","wrapTicks"],["for","email"],["type","email","id","email","placeholder","******","formControlName","email",1,"form-control"],["for","role"],["name","role","id","role","formControlName","role",1,"form-control"],["value",""],["value","ADMIN_ROLE"],["value","USER_ROLE"],["type","usuario",3,"imagen"],["for","file",1,"btn","btn-primary"]],template:function(n,a){if(n&1){let b=V();i(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"h2"),o(5,"Editar Usuario"),e(),i(6,"button",5),o(7,"Listado de Usuarios"),e()()(),y(8,me,5,14,"div",6),i(9,"div",7)(10,"form",8),R("ngSubmit",function(){return _(b),I(a.saved())}),i(11,"div",9)(12,"label",10),o(13,"Nombre"),e(),d(14,"input",11),e(),i(15,"div",9)(16,"label",12),o(17,"Tel\xE9fono"),e(),d(18,"input",13),e(),i(19,"div",9)(20,"label",14),o(21,"Peso"),e(),d(22,"input",15),e(),i(23,"div",9)(24,"label",16),o(25,"Sexo"),e(),i(26,"select",17)(27,"option",18),o(28,"Masculino"),e(),i(29,"option",19),o(30,"Femenino"),e()()(),i(31,"div",9)(32,"label",20),o(33,"Contrase\xF1a"),e(),d(34,"input",21),e(),i(35,"div",9)(36,"label",22),o(37,"Repetir Contrase\xF1a"),e(),d(38,"input",23),e(),y(39,de,4,0,"div",24)(40,ue,10,0,"div",24),i(41,"div",25)(42,"button",26),o(43,"Enviar"),e(),i(44,"label",27),o(45," Cambiar Inagen "),e()()()(),i(46,"div",28)(47,"input",29),R("change",function(U){return _(b),I(a.cambiarImagen(U))}),e(),y(48,pe,2,1,"div",30)(49,ce,2,0,"ng-template",null,0,k),i(51,"h6",31)(52,"strong"),o(53),M(54,"uppercase"),e()()()()()}if(n&2){let b=T(50);m(8),c("ngIf",a.viewChart),m(2),c("formGroup",a.formUser),m(29),c("ngIf",a.user.role==="ADMIN_ROLE"),m(),c("ngIf",a.user.role==="ADMIN_ROLE"),m(8),c("ngIf",a.user.img!=="")("ngIfElse",b),m(5),F(O(54,7,a.user.name))}},dependencies:[se,G,ee,z,Q,W,Y,K,$,q,H,J,B,ne,re],encapsulation:2});let r=w;return r})();var fe=[{path:"",title:"Usuarios",data:{title:"Mi perfil",background:"bg-primary"},loadComponent:()=>ae}],ke=fe;export{ke as default};
